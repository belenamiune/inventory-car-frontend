<div class="px-4 sm:px-6 md:px-10 py-6">
  <!-- Filtros + Botón  -->
  <div class="grid gap-3 md:flex md:justify-between md:items-end mb-4 animate-fade-in">
    <!-- Grupo de Filtros -->
    <div class="grid gap-3 grid-cols-1 sm:grid-cols-2 md:flex md:flex-row md:gap-3 w-full">
      <!-- Buscar por nombre -->
      <span class="p-input-icon-left w-full md:w-60">
        <i class="pi pi-search"></i>
        <input
          type="text"
          pInputText
          [(ngModel)]="nombre"
          placeholder="Buscar por nombre"
          class="w-full"
        />
      </span>

      <!-- Botón Buscar -->
      <button
        pButton
        type="button"
        icon="pi pi-filter"
        label="Buscar"
        class="p-button-outlined w-full md:w-auto"
        (click)="onBuscar()"
      ></button>

      <button
        pButton
        type="button"
        icon="pi pi-times"
        label="Limpiar"
        class="p-button-outlined p-button-secondary w-full md:w-auto"
        (click)="resetFiltros()"
      ></button>
    </div>

    <!-- Botón Nuevo -->
    <div class="w-full md:w-auto">
      <button
        pButton
        icon="pi pi-plus"
        label="Nueva"
        class="p-button-primary w-full md:w-auto"
        (click)="abrirNuevo()"
      ></button>
    </div>
    <button
      pButton
      icon="pi pi-folder-open"
      class="p-button-md bg-green-600 border-green-600 hover:bg-green-700 hover:border-green-700 text-white text-center"
      [routerLink]="['/categorias/arbol']"
    ></button>
  </div>

  <!-- Tabla de categorías -->
  <div class="mt-4">
    <h2 class="text-xl font-semibold text-gray-700 dark:text-gray-200 mb-3 mt-5">
      Listado de Categorías
    </h2>

    <p-table
      class="animate-fade-in min-w-full mt-4 bg-white dark:bg-gray-800 text-gray-800 dark:text-gray-100 border-gray-200 dark:border-gray-700 rounded-lg overflow-hidden"
      [value]="(categorias$ | async) || []"
      [paginator]="true"
      [rows]="rows"
      [totalRecords]="(total$ | async) || 0"
      [lazy]="true"
      (onLazyLoad)="onPageChange($event)"
      [loading]="(loading$ | async) || false"
      responsiveLayout="scroll"
      scrollHeight="flex"
    >
      <ng-template pTemplate="header">
        <tr class="bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-200">
          <th>Nombre</th>
          <th>Padre</th>
          <th class="text-center">Acciones</th>
        </tr>
      </ng-template>

      <ng-template pTemplate="body" let-categoria>
        <tr class="border-b border-gray-200 dark:border-gray-700">
          <td>
            <span
              [ngClass]="[
                getCategoriaStyles(categoria.nombre).bg,
                getCategoriaStyles(categoria.nombre).text,
                'p-tag p-tag-rounded text-xs'
              ]"
            >
              <i class="{{ getCategoriaStyles(categoria.nombre).icon }} mr-1"></i>
              {{ categoria.nombre }}
            </span>
          </td>
          <td>{{ categoria.padre?.nombre || '---' }}</td>

          <td class="text-center">
            <button
              pButton
              icon="pi pi-pencil"
              class="p-button-sm p-button-text text-primary"
              (click)="abrirEdicion(categoria)"
            ></button>

            <button
              pButton
              icon="pi pi-trash"
              class="p-button-sm p-button-text text-red-500"
              (click)="confirmarEliminar(categoria)"
            ></button>
          </td>
        </tr>
      </ng-template>
    </p-table>
  </div>

  <!-- Modal -->
  <app-categoria-form
    [visible]="modalVisible"
    [categoria]="categoriaSeleccionada"
    [categorias]="(categorias$ | async) || []"
    (cerrar)="cerrarModal()"
    (guardar)="guardarCategoria($event)"
  >
  </app-categoria-form>

  <p-confirmDialog></p-confirmDialog>
</div>
